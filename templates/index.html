<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid ECC-AES192: Secure Key Exchange & File Encryption</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/process.css') }}">
</head>
<body>
    </div>

    <div class="container">
        <!-- Navigation Tabs -->
        <ul class="nav nav-pills mb-4" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="process-tab" data-bs-toggle="tab" data-bs-target="#process" type="button" role="tab">
                    <i class="fas fa-cogs me-2"></i>Process
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="analysis-tab" data-bs-toggle="tab" data-bs-target="#analysis" type="button" role="tab">
                    <i class="fas fa-chart-line me-2"></i>Performance Analysis
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="about-tab" data-bs-toggle="tab" data-bs-target="#about" type="button" role="tab">
                    <i class="fas fa-info-circle me-2"></i>About
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="mainTabContent">
            <!-- Process Tab -->
            <div class="tab-pane fade show active" id="process" role="tabpanel">
                <div class="process-container">
                    <!-- HEADER -->
                    <header class="process-header">
                        <h1>Hybrid ECCâ€“AES192</h1>
                        <p>Secure Key Exchange & File Encryption</p>
                    </header>

                    <!-- STEPPER -->
                    <div class="process-stepper">
                        <div class="process-step active" data-step="1">
                            <span>1</span> Generate
                        </div>
                        <div class="process-step" data-step="2">
                            <span>2</span> Exchange
                        </div>
                        <div class="process-step" data-step="3">
                            <span>3</span> Encrypt
                        </div>
                        <div class="process-step" data-step="4">
                            <span>4</span> Decrypt
                        </div>
                    </div>

                    <!-- STEP 1: GENERATE KEYS -->
                    <div class="step-content active" id="step1">
                        <div class="process-card">
                            <h2>Generate ECC Keypairs</h2>

                            <label class="process-label">Curve</label>
                            <select class="process-select">
                                <option>secp256r1</option>
                            </select>

                            <button class="process-button" onclick="generateKeys()" id="generateKeysBtn">
                                Generate Keypair
                            </button>

                            <div class="process-result" id="keyResults"></div>
                        </div>
                    </div>

                    <!-- STEP 2: KEY EXCHANGE -->
                    <div class="step-content" id="step2">
                        <div class="process-card">
                            <h2>ECDH Key Exchange</h2>

                            <label class="process-label">Public Keys</label>
                            <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 12px; margin-bottom: 20px; font-family: monospace; font-size: 12px;">
                                <div><strong>Alice:</strong> <span id="alicePubKey">Not generated</span></div>
                                <div><strong>Bob:</strong> <span id="bobPubKey">Not generated</span></div>
                            </div>

                            <button class="process-button" onclick="performKeyExchange()" id="keyExchangeBtn" disabled>
                                Perform Key Exchange
                            </button>

                            <div class="process-result" id="exchangeResults"></div>
                        </div>
                    </div>

                    <!-- STEP 3: ENCRYPT FILE -->
                    <div class="step-content" id="step3">
                        <div class="process-card">
                            <h2>Encrypt File</h2>

                            <label class="process-label">Choose File</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="encryptFile" class="process-select" onchange="updateFileInfo(this, 'encrypt')">
                                <div class="file-info" id="encryptFileInfo"></div>
                            </div>

                            <label class="process-label">Encryption Mode</label>
                            <select class="process-select" id="encryptMode">
                                <option value="gcm">AES-192-GCM (Recommended)</option>
                                <option value="cbc">AES-192-CBC</option>
                            </select>

                            <button class="process-button" onclick="encryptFile()" id="encryptBtn" disabled>
                                Encrypt File
                            </button>

                            <div class="process-result" id="encryptResults"></div>
                        </div>
                    </div>

                    <!-- STEP 4: DECRYPT FILE -->
                    <div class="step-content" id="step4">
                        <div class="process-card">
                            <h2>Decrypt File</h2>

                            <label class="process-label">Choose Encrypted File</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="decryptFile" class="process-select" onchange="updateFileInfo(this, 'decrypt')">
                                <div class="file-info" id="decryptFileInfo"></div>
                            </div>

                            <button class="process-button" onclick="decryptFile()" id="decryptBtn" disabled>
                                Decrypt File
                            </button>

                            <div class="process-result" id="decryptResults"></div>
                        </div>
                    </div>

                    <!-- DANGER ZONE -->
                    <div class="process-danger">
                        <h3>Danger Zone</h3>
                        <p>Reset system (clear keys & files)</p>
                        <button onclick="resetSystem()">Reset</button>
                    </div>
                </div>
            </div>

            <!-- Performance Analysis Tab -->
            <div class="tab-pane fade" id="analysis" role="tabpanel">
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header performance-stats">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-line me-2"></i>Performance Analysis
                                </h5>
                            </div>
                            <div class="card-body">
                                <button class="btn btn-primary mb-3" onclick="loadPerformance()">
                                    <i class="fas fa-sync me-2"></i>Refresh Performance Data
                                </button>
                                
                                <div id="performanceContent">
                                    <div class="row" id="statsCards">
                                        <!-- Stats will be populated here -->
                                    </div>
                                    
                                    <div class="mt-4">
                                        <h6>Operation Logs</h6>
                                        <div class="table-responsive">
                                            <table class="table table-striped" id="logsTable">
                                                <thead>
                                                    <tr>
                                                        <th>Operation</th>
                                                        <th>Time (s)</th>
                                                        <th>Details</th>
                                                        <th>Timestamp</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Logs will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- About Tab -->
            <div class="tab-pane fade" id="about" role="tabpanel">
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <div class="card">
                            <div class="card-header bg-dark text-white">
                                <h5 class="mb-0">
                                    <i class="fas fa-info-circle me-2"></i>About Hybrid ECC-AES192 System
                                </h5>
                            </div>
                            <div class="card-body">
                                <h6>System Overview</h6>
                                <p>This web application demonstrates a hybrid cryptosystem combining Elliptic Curve Cryptography (ECC) with Advanced Encryption Standard (AES-192) for secure key exchange and file encryption.</p>
                                
                                <h6>Key Components</h6>
                                <ul>
                                    <li><strong>ECC (secp256r1):</strong> Generates keypairs for Alice and Bob</li>
                                    <li><strong>ECDH:</strong> Elliptic Curve Diffie-Hellman for secure key exchange</li>
                                    <li><strong>HKDF:</strong> HMAC-based Key Derivation Function to derive AES-192 keys</li>
                                    <li><strong>AES-192:</strong> Symmetric encryption for file data (GCM/CBC modes)</li>
                                </ul>
                                
                                <h6>Security Features</h6>
                                <ul>
                                    <li>Forward secrecy through ECDH</li>
                                    <li>Authentication via GCM mode</li>
                                    <li>Secure key derivation with HKDF</li>
                                    <li>No private key transmission</li>
                                </ul>
                                
                                <h6>Technical Specifications</h6>
                                <ul>
                                    <li>ECC Curve: secp256r1 (prime256v1)</li>
                                    <li>Symmetric Algorithm: AES-192</li>
                                    <li>Key Derivation: HKDF-SHA256</li>
                                    <li>Max File Size: 16MB</li>
                                </ul>
                                
                                <div class="alert alert-info mt-3">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>Note:</strong> This is an educational demonstration for academic purposes. For production use, additional security measures should be implemented.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{{ url_for('static', filename='js/process.js') }}"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
